# ‚òÄÔ∏è‚ö°SolarMLProject
## Overview
This repository documents our final project for the **B.Sc. in Electrical Engineering at Tel Aviv University**.
The project was conducted by **Hadar Levy** and **Gal Schwartz**, under the supervision of **Khen Cohen**.

## Objective
The goal of this project is to develop a machine learning model based on a hybrid architecture of **Graph Attention Networks (GATs)** and **Long Short-Term Memory (LSTM) networks**, designed to predict **Global Horizontal Irradiance (GHI)** for four future horizons: **15, 30, 45, and 60 minutes ahead**.
By modeling Israel‚Äôs photovoltaic (PV) network as a graph, the system captures both temporal dynamics (via LSTMs) and spatial dependencies (via GATs), enabling more accurate short-term forecasts critical for smart grid management.

## Repository Layout
- `.idea/` ‚Äì IDE config.
- [`Batching_Nodes/`](./Batching_Nodes) ‚Äì Code for node batching and preparation for GNN (an alternative method we tested but ultimately did not use).
- [`Clouds_Simulator/`](./Clouds_Simulator) ‚Äì Code for creating a synthetic dataset using cloud masks generated by the cloud simulator from this repo: https://github.com/khencohen/SolarPanels. This approach was eventually abandoned due to computational constraints.
- [`Correlations/`](./Correlations) ‚Äì Scripts for correlation calculations.
- [`Data/`](./Data) ‚Äì Processed datasets for training and testing.
- [`Metrics/`](./Metrics) ‚Äì Evaluation scripts for error metrics and comparisons.
- [`Model/`](./Model) ‚Äì GNN model definitions and training logic.
- [`Project/`](./Project) ‚Äì Project documentation:
  - Project book
  - Final presentation (PPTX)
  - Poster
- [`Results/`](./Results) ‚Äì Forecast output plots and visualizations. Visualized predictions for 15, 30, 45, and 60-minute horizons.
- [`data_processing/`](./data_proccessing) ‚Äì Scripts to create and convert datasets into graph format.
- [`README.md`](./README.md) ‚Äì This documentation file.

## Results / Evaluation
The model‚Äôs accuracy was evaluated using **Normalized Root Mean Square Error (NRMSE)** and **Normalized Mean Absolute Error (NMAE)**.

| Time Horizon | NRMSE (%) | NMAE (%) |
|--------------|-----------|----------|
| 15 minutes   |    8.25   |   11.35  |
| 30 minutes   |    9.13   |   13.16  |
| 45 minutes   |    10.02  |   15.14  |
| 60 minutes   |    10.76  |   16.46  |

### üìà Forecast vs. Actual for GHI @ t+15 minutes
![Actual Versus Prediction for 15 minutes forecasting](Results/+15/forecast_node0_t+15.png)

## Limitations and Future Work
- **Overfitting**: Training was limited by computational resources. Expanding training volume and graph scope would likely improve generalization.
- **Data realism**: Current datasets are based on simulated GHI (NREL). Incorporating real sensor data could improve robustness.
- **Geographical scaling**: Extending beyond the Jerusalem region to all of Israel‚Äôs climate zones.
- **Future directions**:
  - Cloud-based intermediate forecasting (using satellite/cloud simulators).
  - Impact of PV network density on forecast accuracy.
  - Estimation of GHI at unsensed locations via graph-based spatial interpolation

## References & Acknowledgements
This project makes use of external tools and datasets, including:
- **SatelliteCloudGenerator**
  - Repository: [strath-ai/SatelliteCloudGenerator](https://github.com/strath-ai/SatelliteCloudGenerator)  
  - Publication: Czerkawski, M.; Atkinson, R.; Michie, C.; Tachtatzis, C. SatelliteCloudGenerator: Controllable Cloud and Shadow Synthesis for Multi-Spectral Optical Satellite Images. Remote Sensing 2023, 15(17), 4138. https://doi.org/10.3390/rs15174138
 - **SolarPanels Cloud Simulator**
  - Repository: [khencohen/SolarPanels](https://github.com/khencohen/SolarPanels)  

## Credits
This project was developed by Hadar Levy and Gal Schwartz under the supervision of Khen Cohen at Tel Aviv University.
